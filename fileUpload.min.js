/**
 * fileUpload plugin for jQuery
 * WTFPL
 */
(function(b){function a(d,e){var c=this;c.id=null;c.input=null;c.files=null;c.onChange=typeof e.change==="function"?e.change:function(){};this.init=function(){var h=Math.floor(Math.random()*9999999999999)+1;c.id="FU_"+h;var g=b(d).prop("name");b(d).removeAttr("name");var f=(typeof e.multi!=="undefined"&&e.multi)?"multiple":"";var i=(typeof e.accept!=="undefined"&&e.accept)?e.accept:"";var j=b('<input type="file" name="'+g+'" id="'+c.id+'" accept="'+i+'" style="opacity:0; position:absolute;" '+f+"/>");c.input=j[0];b(c.input).insertAfter(d);c.setHandlers()};this.clearFiles=function(){if(c.input.value){try{c.input.value=""}catch(i){}if(c.input.value){var h=document.createElement("form"),f=c.input.parentNode,g=c.input.nextSibling;h.appendChild(c.input);h.reset();f.insertBefore(c.input,g)}}};c.setHandlers=function(){b(d).unbind("click").click(function(f){f.preventDefault();c.input.click()});b(c.input).unbind("change").change(function(f){c.files=f.target.files;c.onChange()})};this.getFiles=function(){return c.files};this.getFileText=function(g){if(window.File&&window.FileReader&&window.FileList&&window.Blob){for(var h=0;h<c.files.length;h++){var k=c.files[h];if(!k){continue}var j=new FileReader;j.onload=function(f){g(f.target.result)};j.readAsText(k)}}else{return false}return true};this.getDataURI=function(g){if(window.File&&window.FileReader&&window.FileList&&window.Blob){for(var h=0;h<c.files.length;h++){var k=c.files[h];if(!k){continue}var j=new FileReader;j.onload=function(f){g(f.target.result)};j.readAsDataURL(k)}}else{return false}return true};c.init()}b.fn.fileUpload=function(d,c){if(this.length===1&&typeof d==="string"&&b(this[0]).data("fuInstance")!=="undefined"){return b(this).data("fuInstance")[d](c)}return this.each(function(){params=typeof d==="object"?d:{};if(typeof b(this).data("fuInstance")==="undefined"){b(this).data("fuInstance",new a(this,params))}})}})(jQuery);