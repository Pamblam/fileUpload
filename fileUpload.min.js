/*! file-upload - v1.2.1 */
!function(e){function n(n,t){var a=this;a.id=null,a.input=null,a.files=null,a.onChange="function"==typeof t.change?t.change:function(){},a.onProgress="function"==typeof t.progress?t.progress:function(){},a.onUploaded="function"==typeof t.uploaded?t.uploaded:function(){},a.dragEnterClassName="dragEnter",a.acceptedTypes="",a.multi=!1,a.url="string"==typeof t.url?t.url:""+window.location,a.dragNdropEnabled=function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window},a.init=function(){var r=Math.floor(9999999999999*Math.random())+1;a.id="FU_"+r;var i=e(n).prop("name");e(n).removeAttr("name"),void 0!==t.dragEnterClass&&(a.dragEnterClassName=t.dragEnterClass),void 0!==t.dragArea&&a.dragArea(t.dragArea),a.multi=!!t.multi;var o=a.multi?"multiple":"";a.acceptedTypes=void 0!==t.accept&&t.accept?t.accept:"";var l=e('<input type="file" name="'+i+'" id="'+a.id+'" accept="'+a.acceptedTypes+'" style="opacity:0; position:absolute;" '+o+"/>");a.input=l[0],e(a.input).insertAfter(n),a.setHandlers()},a.clearFiles=function(){a.files=[],a.input.value=""},a.setHandlers=function(){e(n).unbind("click").click(function(e){e.preventDefault(),a.input.click()}),e(a.input).unbind("change").change(function(e){a.files&&a.multi||(a.files=[]);for(var n=0;n<e.target.files.length;n++)a.files.push(e.target.files[n]);a.files.length||(a.files=null),a.onChange()})},a.getFiles=function(){return a.files},a.getFileText=function(e){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return!1;for(var n=0;n<a.files.length;n++){var t=a.files[n];if(t){var r=new FileReader;r.onload=function(n){e(n.target.result)},r.readAsText(t)}}return!0},a.getDataURI=function(e){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return!1;for(var n=0;n<a.files.length;n++){var t=a.files[n];if(t){var r=new FileReader;r.onload=function(n){e(n.target.result)},r.readAsDataURL(t)}}return!0},a.dragEnterClass=function(e){a.dragEnterClassName=e},a.dragArea=function(n){if(!a.dragNdropEnabled)return!1;e(n).on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){e(n).addClass(a.dragEnterClassName)}).on("dragleave dragend drop",function(){e(n).removeClass(a.dragEnterClassName)}).on("drop",function(e){var n=e.originalEvent.dataTransfer.files;a.files||(a.files=[]);for(var t=0;t<n.length;t++)(""===a.acceptedTypes||a.acceptedTypes.indexOf(n[t].type)>-1)&&a.files.push(n[t]);a.files.length||(a.files=null),a.onChange()})},a.upload=function(){for(var n=new FormData,t=a.files.length;t--;)n.append("fileUploadFiles[]",a.files[t],a.files[t].name);e.ajax({url:a.url,type:"POST",data:n,processData:!1,contentType:!1,xhr:function(){var e=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var n=e.loaded/e.total;n=parseInt(100*n),a.onProgress(n)}},!1),e}}).always(function(e){a.onUploaded(void 0===e.responseText?e:e.responseText)})},a.init()}e.fn.fileUpload=function(t,a){return 1===this.length&&"string"==typeof t&&"undefined"!==e(this[0]).data("fuInstance")?e(this).data("fuInstance")[t](a):this.each(function(){params="object"==typeof t?t:{},void 0===e(this).data("fuInstance")&&e(this).data("fuInstance",new n(this,params))})}}(jQuery);