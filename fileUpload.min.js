/*! file-upload - v1.3.0 */
!function(l){function n(e,t){var n=this;n.id=null,n.input=null,n.files=null,n.onChange="function"==typeof t.change?t.change:function(){},n.onProgress="function"==typeof t.progress?t.progress:function(){},n.onUploaded="function"==typeof t.uploaded?t.uploaded:function(){},n.dragEnterClassName="dragEnter",n.acceptedTypes="",n.multi=!1,n.url="string"==typeof t.url?t.url:""+window.location,n.context=e||t.dragArea;var a=Math.floor(9999999999999*Math.random())+1;n.id="FU_"+a;var r="fileUploadFile";e&&(r=l(e).prop("name"),l(e).removeAttr("name")),t.name&&(r=t.name),void 0!==t.dragEnterClass&&(n.dragEnterClassName=t.dragEnterClass),void 0!==t.dragArea&&n.dragArea(t.dragArea),n.multi=!!t.multi;var i=n.multi?"multiple":"";n.acceptedTypes=void 0!==t.accept&&t.accept?t.accept:"";var o=l('<input type="file" name="'+r+'" id="'+n.id+'" accept="'+n.acceptedTypes+'" style="z-index:-999999; opacity:0; position:absolute;" '+i+"/>");n.input=o[0],t.form?l(n.input).insertAfter(t.form):e?l(n.input).insertAfter(e):t.dragArea?l(n.input).insertAfter(t.dragArea):l(body).append(n.input),e&&l(e).click(function(e){e.preventDefault(),n.input.click()}),l(n.input).unbind("change").change(function(e){n.files&&n.multi||(n.files=[]);for(var t=0;t<e.target.files.length;t++)n.files.push(e.target.files[t]);n.files.length||(n.files=null),n.onChange.call(n.context,e)})}n.prototype.dragNdropEnabled=function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window},n.prototype.clearFiles=function(){this.files=[],this.input.value=""},n.prototype.getFiles=function(){return this.files},n.prototype.getFileText=function(t){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return!1;for(var e=0;e<this.files.length;e++){var n=this.files[e];if(n){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsText(n)}}return!0},n.prototype.getDataURI=function(t){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return!1;for(var e=0;e<this.files.length;e++){var n=this.files[e];if(n){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsDataURL(n)}}return!0},n.prototype.dragEnterClass=function(e){this.dragEnterClassName=e},n.prototype.dragArea=function(e){var i=this;if(!i.dragNdropEnabled)return!1;l(e).on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){l(e).addClass(i.dragEnterClassName)}).on("dragleave dragend drop",function(){l(e).removeClass(i.dragEnterClassName)}).on("drop",function(e){var t=e.originalEvent.dataTransfer.files;i.files||(i.files=[]);for(var n=0,a=0;a<t.length;a++){var r=t[a].name.split(".").pop();if((""===i.acceptedTypes||-1<i.acceptedTypes.indexOf(t[a].type)||-1<i.acceptedTypes.indexOf(r)||-1<i.acceptedTypes.indexOf("."+r))&&(i.multi||(i.files=[]),i.files.push(t[a]),n++,!i.multi))break}i.files.length||(i.files=null),n&&i.onChange.call(i.context,e)})},n.prototype.upload=function(){for(var n=this,e=new FormData,t=n.files.length;t--;)e.append("fileUploadFiles[]",n.files[t],n.files[t].name);l.ajax({url:n.url,type:"POST",data:e,processData:!1,contentType:!1,xhr:function(){var e=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=e.loaded/e.total;t=parseInt(100*t),n.onProgress.call(n.context,t,e)}},!1),e}}).always(function(e){n.onUploaded.call(n.context,void 0===e.responseText?e:e.responseText)})},l.fileUpload=function(e){},l.fn.fileUpload=function(e,t){return 1===this.length&&"string"==typeof e&&"undefined"!==this.data("fuInstance")?this.data("fuInstance")[e](t):this.each(function(){params="object"==typeof e?e:{},void 0===l(this).data("fuInstance")&&l(this).data("fuInstance",new n(this,params))})}}(jQuery);