!function(a){function b(b,c){var d=this;d.id=null,d.input=null,d.files=null,d.onChange="function"==typeof c.change?c.change:function(){},d.onProgress="function"==typeof c.progress?c.progress:function(){},d.onUploaded="function"==typeof c.uploaded?c.uploaded:function(){},d.dragEnterClassName="dragEnter",d.acceptedTypes="",d.multi=!1,d.url="string"==typeof c.url?c.url:""+window.location,d.dragNdropEnabled=function(){var a=document.createElement("div");return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&"FormData"in window&&"FileReader"in window},d.init=function(){var e=Math.floor(9999999999999*Math.random())+1;d.id="FU_"+e;var f=a(b).prop("name");a(b).removeAttr("name"),void 0!==c.dragEnterClass&&(d.dragEnterClassName=c.dragEnterClass),void 0!==c.dragArea&&d.dragArea(c.dragArea),d.multi=!!c.multi;var g=d.multi?"multiple":"";d.acceptedTypes=void 0!==c.accept&&c.accept?c.accept:"";var h=a('<input type="file" name="'+f+'" id="'+d.id+'" accept="'+d.acceptedTypes+'" style="opacity:0; position:absolute;" '+g+"/>");d.input=h[0],a(d.input).insertAfter(b),d.setHandlers()},d.clearFiles=function(){if(d.input.value){try{d.input.value=""}catch(a){}if(d.input.value){var a=document.createElement("form"),b=d.input.parentNode,c=d.input.nextSibling;a.appendChild(d.input),a.reset(),b.insertBefore(d.input,c)}}},d.setHandlers=function(){a(b).unbind("click").click(function(a){a.preventDefault(),d.input.click()}),a(d.input).unbind("change").change(function(a){d.files&&d.multi||(d.files=[]);for(var b=0;b<a.target.files.length;b++)d.files.push(a.target.files[b]);d.files.length||(d.files=null),d.onChange()})},d.getFiles=function(){return d.files},d.getFileText=function(a){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return!1;for(var b=0;b<d.files.length;b++){var c=d.files[b];if(c){var e=new FileReader;e.onload=function(b){a(b.target.result)},e.readAsText(c)}}return!0},d.getDataURI=function(a){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return!1;for(var b=0;b<d.files.length;b++){var c=d.files[b];if(c){var e=new FileReader;e.onload=function(b){a(b.target.result)},e.readAsDataURL(c)}}return!0},d.dragEnterClass=function(a){d.dragEnterClassName=a},d.dragArea=function(b){if(!d.dragNdropEnabled)return!1;a(b).on("drag dragstart dragend dragover dragenter dragleave drop",function(a){a.preventDefault(),a.stopPropagation()}).on("dragover dragenter",function(){a(b).addClass(d.dragEnterClassName)}).on("dragleave dragend drop",function(){a(b).removeClass(d.dragEnterClassName)}).on("drop",function(a){var b=a.originalEvent.dataTransfer.files;d.files||(d.files=[]);for(var c=0;c<b.length;c++)(""===d.acceptedTypes||d.acceptedTypes.indexOf(b[c].type)>-1)&&d.files.push(b[c]);d.files.length||(d.files=null),d.onChange()})},d.upload=function(){for(var b=new FormData,c=d.files.length;c--;)b.append("fileUploadFiles[]",d.files[c],d.files[c].name);a.ajax({url:d.url,type:"POST",data:b,processData:!1,contentType:!1,xhr:function(){var a=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;b=parseInt(100*b),d.onProgress(b)}},!1),a}}).always(function(a){d.onUploaded(void 0===a.responseText?a:a.responseText)})},d.init()}a.fn.fileUpload=function(c,d){return 1===this.length&&"string"==typeof c&&"undefined"!==a(this[0]).data("fuInstance")?void 0===d?a(this).data("fuInstance")[c]():a(this).data("fuInstance")[c](d):this.each(function(){params="object"==typeof c?c:{},void 0===a(this).data("fuInstance")&&a(this).data("fuInstance",new b(this,params))})}}(jQuery);